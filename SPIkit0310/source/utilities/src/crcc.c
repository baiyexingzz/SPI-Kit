/******************************************************************************/
/*                                                                            */
/*    $Workfile::   crc.c                                                $    */
/*                                                                            */
/*    $Revision:: 886                                                    $    */
/*                                                                            */
/*     $Archive::                                                        $    */
/*                                                                            */
/*     $Modtime::                                                        $    */
/*                                                                            */
/*        $Date:: 2009-06-24 00:24:09 +0800 (周三, 24 六月 2009)     $    */
/*                                                                            */
/*      $Author:: MartienVanDerMeij                                      $    */
/*                                                                            */
/*        Owner::   Wijnand Rietman                                           */
/*                                                                            */
/*  Description::   <Enter description here>                                  */
/*                                                                            */
/*   Department::   B.G. Lighting Electronics                                 */
/*                                                                            */
/*                  Philips Company Confidential.                             */
/*                  Copyright (C) 2006 Koninklijke Philips Electronics N.V.   */
/*                  All rights reserved.                                      */
/*                                                                            */
/******************************************************************************/

/******************************************************************************/
/*                               INCLUDE FILES                                */
/******************************************************************************/

#include "platform.h"
#include "stdtypes.h"

#include "crc.h"

/******************************************************************************/
/*                            CONSTANT DEFINITIONS                            */
/******************************************************************************/

/******************************************************************************/
/*                              MACRO DEFINITIONS                             */
/******************************************************************************/

/******************************************************************************/
/*                              TYPE DEFINITIONS                              */
/******************************************************************************/

/******************************************************************************/
/*                          PUBLIC DATA DEFINITIONS                           */
/******************************************************************************/

/******************************************************************************/
/*                          PRIVATE DATA DEFINITIONS                          */
/******************************************************************************/

/******************************************************************************/
/*                        PRIVATE FUNCTION PROTOTYPES                         */
/******************************************************************************/

/******************************************************************************/
/*                      PUBLIC FUNCTION IMPLEMENTATIONS                       */
/******************************************************************************/

UBYTE CRC_ubCrc8(const UBYTE *pubData, UBYTE ubCrc, UBYTE ubNrOfBytes)
/*
**  Description : Calculates the 8-bit CRC with a polynomial of 0x107
**  Parameters  : ubCrc: CRC seed value, normally zero
**  Returns     : The 8-bit CRC
*/
{
  static const UBYTE aubNibbleLow[] =
  {
    0x00, 0x5E, 0xBC, 0xE2, 0x61, 0x3F, 0xDD, 0x83,
    0xC2, 0x9C, 0x7E, 0x20, 0xA3, 0xFD, 0x1F, 0x41,
  };

  static const UBYTE aubNibbleHigh[] =
  {
    0x00, 0x9D, 0x23, 0xBE, 0x46, 0xDB, 0x65, 0xF8,
    0x8C, 0x11, 0xAF, 0x32, 0xCA, 0x57, 0xE9, 0x74
  };

  UBYTE ubIndex;

  while (ubNrOfBytes-- > 0)
  {
    ubIndex = (UBYTE)(*pubData++ ^ ubCrc);
    ubCrc = (UBYTE)(aubNibbleLow[ubIndex & 0x0F] ^ aubNibbleHigh[ubIndex >> 4]);
  }

  return (ubCrc);
}

/******************************************************************************/
/*                      PRIVATE FUNCTION IMPLEMENTATIONS                      */
/******************************************************************************/

/******************************************************************************/
/*                                 END OF FILE                                */
/******************************************************************************/
